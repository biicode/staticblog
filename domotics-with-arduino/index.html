<!DOCTYPE html><html
lang="en-US" xmlns:fb="http://ogp.me/ns/fb#" xmlns:addthis="http://www.addthis.com/help/api-spec"  prefix="og: http://ogp.me/ns#">
<!-- Mirrored from blog.biicode.com/domotics-with-arduino/ by HTTrack Website Copier/3.x [XR&CO'2014], Sun, 03 Jan 2016 00:31:16 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- /Added by HTTrack -->
<head><link
rel='stylesheet' href='../wp-content/plugins/wp-minify/min/index1667.css?f=wp-content/plugins/wp-currency-converter/css/wp-currency-converter.css,wp-content/plugins/addthis/css/output.css,wp-content/plugins/crayon-syntax-highlighter/css/min/crayon.min.css,wp-content/uploads/sites/2/crayon-syntax-highlighter/themes/biicode/biicode.css,wp-content/plugins/crayon-syntax-highlighter/fonts/inconsolata.css,wp-content/plugins/cookie-law-info/css/cli-style.css,wp-content/themes/truly-minimal-wpcom/style.css,wp-content/plugins/tablepress/css/default.min.css&amp;m=1434970912' type='text/css' media='screen' /> <script type='text/javascript' src='../wp-content/plugins/wp-minify/min/index5cdb.css?f=wp-content/themes/truly-minimal-wpcom/js/html5.js,wp-includes/js/jquery/jquery.js,wp-includes/js/jquery/jquery-migrate.min.js,wp-content/plugins/q2w3-fixed-widget/js/q2w3-fixed-widget.min.js,wp-content/plugins/wp-currency-converter/js/wp-currency-converter.js,wp-content/plugins/crayon-syntax-highlighter/js/min/crayon.min.js,wp-content/plugins/cookie-law-info/js/cookielawinfo.js&amp;m=1434970912'></script> <meta
charset="UTF-8" /><meta
name="viewport" content="width=device-width" /><title>Project Domo: Domotics with Arduino - biicode Blog</title><link
rel="profile" href="http://gmpg.org/xfn/11" /><link
rel="pingback" href="../xmlrpc.php" /> <!--[if lt IE 9]> <![endif]--> <script type="text/javascript" src="../../biiwebproduction.s3.amazonaws.com/static/js/home/jquery-1.7.1.min.js"></script> <script type="text/javascript" src="../../biiwebproduction.s3.amazonaws.com/static/js/home/jquery.easing.1.3.js"></script> <script type="text/javascript" src="../../biiwebproduction.s3.amazonaws.com/static/js/nav/nav.js"></script> <meta
name="description" content="Project Domo: Domotics with Arduino is being ran with biicode to showcase the fast programming environment it provides to Arduino makers."/><link
rel="canonical" href="index.html" /><link
rel="publisher" href="http://plus.google.com/+biicode"/><meta
property="og:locale" content="en_US" /><meta
property="og:type" content="article" /><meta
property="og:title" content="Project Domo: Domotics with Arduino - biicode Blog" /><meta
property="og:description" content="Project Domo: Domotics with Arduino is being ran with biicode to showcase the fast programming environment it provides to Arduino makers." /><meta
property="og:url" content="http://blog.biicode.com/domotics-with-arduino/" /><meta
property="og:site_name" content="biicode Blog" /><meta
property="article:publisher" content="https://www.facebook.com/Biicode" /><meta
property="article:tag" content="arduino" /><meta
property="article:tag" content="domotics" /><meta
property="article:tag" content="Domotics with Arduino" /><meta
property="article:tag" content="Project Domo" /><meta
property="article:section" content="Arduino" /><meta
property="article:published_time" content="2015-04-24T12:26:22+00:00" /><meta
property="article:modified_time" content="2015-04-24T13:07:37+00:00" /><meta
property="og:updated_time" content="2015-04-24T13:07:37+00:00" /><meta
property="og:image" content="http://blog.biicode.com/wp-content/uploads/sites/2/2015/04/domotica1.png" /><link
rel="alternate" type="application/rss+xml" title="biicode Blog &raquo; Feed" href="http://feeds.feedburner.com/biicodeblog" /><link
rel="alternate" type="application/rss+xml" title="biicode Blog &raquo; Comments Feed" href="../comments/feed/index.html" /><meta
name="twitter:card" content="summary_large_image"><meta
name="twitter:creator" content="@biicode"><meta
name="twitter:site" content="@biicode"><meta
property="og:title" content="Project Domo: Domotics with Arduino - biicode Blog"><meta
property="og:image" content="http://blog.biicode.com/wp-content/uploads/sites/2/2015/04/domotica1.png"><meta
property="og:image:width" content="610"><meta
property="og:image:height" content="610"><link
rel="alternate" type="application/rss+xml" title="biicode Blog &raquo; Project Domo: Domotics with Arduino Comments Feed" href="feed/index.html" /> <script type="text/javascript">window._wpemojiSettings = {"baseUrl":"http:\/\/s.w.org\/images\/core\/emoji\/72x72\/","ext":".png","source":{"concatemoji":"http:\/\/blog.biicode.com\/wp-includes\/js\/wp-emoji-release.min.js?ver=4.2.5"}};
			!function(a,b,c){function d(a){var c=b.createElement("canvas"),d=c.getContext&&c.getContext("2d");return d&&d.fillText?(d.textBaseline="top",d.font="600 32px Arial","flag"===a?(d.fillText(String.fromCharCode(55356,56812,55356,56807),0,0),c.toDataURL().length>3e3):(d.fillText(String.fromCharCode(55357,56835),0,0),0!==d.getImageData(16,16,1,1).data[0])):!1}function e(a){var c=b.createElement("script");c.src=a,c.type="text/javascript",b.getElementsByTagName("head")[0].appendChild(c)}var f,g;c.supports={simple:d("simple"),flag:d("flag")},c.DOMReady=!1,c.readyCallback=function(){c.DOMReady=!0},c.supports.simple&&c.supports.flag||(g=function(){c.readyCallback()},b.addEventListener?(b.addEventListener("DOMContentLoaded",g,!1),a.addEventListener("load",g,!1)):(a.attachEvent("onload",g),b.attachEvent("onreadystatechange",function(){"complete"===b.readyState&&c.readyCallback()})),f=c.source||{},f.concatemoji?e(f.concatemoji):f.wpemoji&&f.twemoji&&(e(f.twemoji),e(f.wpemoji)))}(window,document,window._wpemojiSettings);</script> <style type="text/css">img.wp-smiley,
img.emoji {
	display: inline !important;
	border: none !important;
	box-shadow: none !important;
	height: 1em !important;
	width: 1em !important;
	margin: 0 .07em !important;
	vertical-align: -0.1em !important;
	background: none !important;
	padding: 0 !important;
}</style><link
rel='stylesheet' id='mailchimpSF_main_css-css'  href='../index2740.html?mcsf_action=main_css&amp;ver=4.2.5' type='text/css' media='all' /> <!--[if IE]><link
rel='stylesheet' id='mailchimpSF_ie_css-css'  href='http://blog.biicode.com/wp-content/plugins/mailchimp/css/ie.css?ver=4.2.5' type='text/css' media='all' /> <![endif]--><link
rel='stylesheet' id='truly-minimal-droid-serif-css'  href='http://fonts.googleapis.com/css?family=Droid+Serif%3A400%2C700%2C400italic%2C700italic&amp;ver=4.2.5' type='text/css' media='all' /><link
rel='stylesheet' id='truly-minimal-droid-sans-css'  href='http://fonts.googleapis.com/css?family=Droid+Sans%3A400%2C700&amp;ver=4.2.5' type='text/css' media='all' /> <script type='text/javascript'>/*  */
var CrayonSyntaxSettings = {"version":"2.7.1","is_admin":"0","ajaxurl":"http:\/\/blog.biicode.com\/wp-admin\/admin-ajax.php","prefix":"crayon-","setting":"crayon-setting","selected":"crayon-setting-selected","changed":"crayon-setting-changed","special":"crayon-setting-special","orig_value":"data-orig-value","debug":""};
var CrayonSyntaxStrings = {"copy":"Press %s to Copy, %s to Paste","minimize":"Click To Expand Code"};
/*  */</script> <link
rel="EditURI" type="application/rsd+xml" title="RSD" href="../xmlrpc0db0.php?rsd" /><link
rel="wlwmanifest" type="application/wlwmanifest+xml" href="../wp-includes/wlwmanifest.xml" /><link
rel='shortlink' href='../index1311.html?p=2207' /> <script data-cfasync="false" src="http://load.sumome.com/" data-sumo-site-id="8d5d163c33e2beb1876a5027edd9a9c4c583be61433be230b24e6bcfc0387265" async></script><script type="text/javascript">var wpccAjaxLink = "../wp-admin/admin-ajax.html";</script>  <script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	})(window,document,'script','../../www.google-analytics.com/analytics.js','ga');
	ga('create', 'UA-41860930-1', 'auto');
	ga('require', 'displayfeatures');
	ga('set', 'forceSSL', true);
	ga('send', 'pageview');</script>  <script type="text/javascript">jQuery(document).ready(function(e) {
    jQuery('a').click(function(e) {
		var $this = jQuery(this);
      	var href = $this.prop('href').split('?')[0];
		var ext = href.split('.').pop();
		if ('xls,xlsx,doc,docx,ppt,pot,pptx,pdf,pub,txt,zip,rar,tar,7z,gz,exe,wma,mov,avi,wmv,wav,mp3,midi,csv,tsv,jar,psd,pdn,ai,pez,wwf,torrent,cbr'.split(',').indexOf(ext) !== -1) {
        ga('send', 'event', 'Download', ext, href);
      }
	  if (href.toLowerCase().indexOf('mailto:') === 0) {
        ga('send', 'event', 'Mailto', href.substr(7));
      }
	  if (href.toLowerCase().indexOf('tel:') === 0) {
        ga('send', 'event', 'Phone number', href.substr(4));
      }
      if ((this.protocol === 'http:' || this.protocol === 'index.html') && this.hostname.indexOf(document.location.hostname) === -1) {
        ga('send', 'event', 'Outbound', this.hostname, this.pathname);
      }
	});
});</script> <style type="text/css">.site-title a {
			color: #f48123;
		}</style><link
href='http://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800' rel='stylesheet' type='text/css'></head><body
class="single single-post postid-2207 single-format-standard group-blog sidebar-right"><div
id="ContainerHeader"> <a
id="forkme" href="https://biicode.github.io/biicode"><img
style="z-index: 4;position: absolute; top: 0; left: 0; border: 0;" src="https://camo.githubusercontent.com/8b6b8ccc6da3aa5722903da7b58eb5ab1081adee/68747470733a2f2f73332e616d617a6f6e6177732e636f6d2f6769746875622f726962626f6e732f666f726b6d655f6c6566745f6f72616e67655f6666373630302e706e67" alt="Fork me on GitHub" data-canonical-src="../../s3.amazonaws.com/github/ribbons/forkme_left_orange_ff7600.png"></a><div
id="ContainerwidthHeader"><div
id="header"> <header
id="menu"><div
id="logo"> <a
href="https://www.biicode.com/"><img
src="../wp-content/themes/truly-minimal-wpcom/img/header/biicode-logo.png" alt="Biicode-logo" /></a></div><div
id="search-form"><form
method="get" id="searchform" class="searchform" action="http://blog.biicode.com/" role="search"><div
class="form-container"><input
type="search" class="search-field" name="s" value="" id="s" placeholder="Search in Blog &hellip;" /><div
class="submit-container"><input
name="search" value=""  type="submit" class="submit-bt" /></div></div></form></div> <nav
class="right"><ul><li><a
href="https://www.biicode.com/explore">Explore</a></li><li><a
href="http://web.biicode.com/pricing/">Plans</a></li><li> Learn <img
src="../wp-content/themes/truly-minimal-wpcom/img/header/arrow-drop-down-menu.jpg" style="margin:0px 0px 3px 4px" width="8" height="4" /><ul><li><a
href="http://web.biicode.com/learn/getting-started">Get Started</a></li><li><a
href="https://www.biicode.com/downloads">Downloads</a></li><li><a
href="http://docs.biicode.com/">Docs</a></li><li><a
href="http://forum.biicode.com/">Forum</a></li></ul></li><li><a
href="https://www.biicode.com/accounts/login">Log in</a></li></ul> </nav><div
id="signup-bt"> <img
src="../wp-content/themes/truly-minimal-wpcom/img/header/bt-signup-on.jpg" /> <a
href="https://www.biicode.com/accounts/signup/"><img
class="top" src="../wp-content/themes/truly-minimal-wpcom/img/header/bt-signup-off.jpg" /></a></div> </header></div><p
id="breadcrumbs"><span
xmlns:v="http://rdf.data-vocabulary.org/#"><span
typeof="v:Breadcrumb"><a
href="../index.html" rel="v:url" property="v:title">Biicode Blog</a> » <span
rel="v:child" typeof="v:Breadcrumb"><a
href="../category/arduino/index.html" rel="v:url" property="v:title">Arduino</a> » <strong
class="breadcrumb_last">Project Domo: Domotics with Arduino</strong></span></span></span></p></div></div><div
id="page" class="hfeed site"><div
id="main" class="site-main"><div
id="primary" class="content-area"><div
id="content" class="site-content" role="main"> <article
id="post-2207" class="post-2207 post type-post status-publish format-standard has-post-thumbnail hentry category-arduino tag-arduino-2 tag-domotics tag-domotics-with-arduino tag-project-domo"> <header
class="entry-header"><h1 class="entry-title">Project Domo: Domotics with Arduino</h1><div
class="entry-meta"> Posted on <a
href="index.html" title="12:26" rel="bookmark"><time
class="entry-date" datetime="2015-04-24T12:26:22+00:00">April 24, 2015</time></a><span
class="byline"> by <span
class="author vcard"><a
class="url fn n" href="../author/danimtb/index.html" title="View all posts by danimtb" rel="author">danimtb</a></span></span></div> </header><div
class="entry-content"><p
style="text-align: justify;">Turning the heating on before arriving home, watching real-time video from the inside, automatically turning the alarm on when you leave home… These are common tasks you would like to implement in a smart domotized home.</p><p
style="text-align: justify;">However, incorporating domotic systems to our home is still hard due to lack of an effective, simple and cheap commercial solution that fits our needs, or maybe the steps required to make it yourself are far too complex. When you realize the options available aren’t what you were looking for, and you have tried DIY solutions to automate things with Arduino, the idea comes up clear to your mind: <strong>I want to create my own domotics with arduino</strong>.</p><p
style="text-align: justify;"><img
class="aligncenter wp-image-2230 size-full" src="../wp-content/uploads/sites/2/2015/04/domotica1.png" alt="Domotics with Arduino" width="640" height="350" /></p><p
style="text-align: justify;">In this post I will talk about my domotics project using Arduino to incorporate some automation to my bedroom.</p><p
style="text-align: justify;"><span
id="more-2207"></span></p><h3 style="text-align: justify;">Cheap, simple and completely customizable</h3><p
style="text-align: justify;">When I started to think about my own domotic system I tried to follow three main ideas:</p><ul
style="text-align: justify;"><li><strong>Simple:</strong> Easy to develop system focused on usefulness. Both form the hardware and the software side.</li><li><strong>Cheap:</strong> Minimum high-cost components, standard parts, common Arduino sensors and JUST ONE Arduino board.</li><li><strong>Customizable:</strong> Modular design, easy to expand and completely adjusted to fit someone needs.</li></ul><h1 style="text-align: justify;"><b>Project Domo</b>: Domotics with Arduino</h1><p
style="text-align: justify;">My domotics project is mainly based on the automation of <span
style="text-decoration: underline;">lights</span>, <span
style="text-decoration: underline;">blinds,</span> <span
style="text-decoration: underline;">plugs</span> and the <span
style="text-decoration: underline;">alarm clock</span>.</p><p
style="text-align: justify;">Currently the project is still developing and things working are:</p><ul
style="text-align: justify;"><li>Automatic lights</li><li>Smart plug</li><li>Remote Control</li></ul><p
style="text-align: justify;">This is the configuration of my bedroom:</p><p
style="text-align: justify;"><img
class="  wp-image-2231 aligncenter" src="../wp-content/uploads/sites/2/2015/04/Bedroom1.jpg" alt="Bedroom" width="490" height="296" /></p><ul
style="text-align: justify;"><li><span
style="text-decoration: underline;">Two lights</span>, one in the corridor (at the entrance) and the main light.</li><li><span
style="text-decoration: underline;">Two double three-way-switches</span>, one next to the door and the other one nex to to my bed.</li><li><span
style="text-decoration: underline;">One plug</span> at the right wall.</li><li><span
style="text-decoration: underline;">Arduino MEGA 2560</span> next to the bed (centralized control).</li></ul><h2 style="text-align: justify;"><strong><strong> </strong></strong><b>Materials</b></h2><ul
style="text-align: justify;"><li>Arduino Mega 2560</li><li>2 PIR sensors</li><li>4 conductor wire</li><li>3 Relay modules</li><li>Buttons</li><li>IR receiver</li><li>Remote Control</li></ul><p
style="text-align: justify;">The domotic system incorporates just one <strong>Arduino Mega 2560</strong> board to ensure a high amount of digital I/O pins. The board is connected to different electronic modules of sensors/actuators by a <strong>4 conductor wire</strong>.</p><p
style="text-align: justify;"><img
class="  aligncenter wp-image-2221" title="4 conductor wire in display for the hardware lovers!" src="../wp-content/uploads/sites/2/2015/04/4-connector-wirepp-300x169.jpg" alt="Domotics with Arduino requires indeed of good Arduino boards and cables" width="364" height="205" /></p><p
style="text-align: justify;">The original wires for the switches of my bedroom were replaced by this other kind. Power supply goes directly to the lights which are now controlled by a relay.</p><p
style="text-align: justify;"><strong>Plugs</strong> maintain original wiring and are only equipped with another relay to control power supply and a button to interact with its operation modes.</p><p
style="text-align: justify;"><strong>PIR (Passive InfraRed)</strong> sensors are placed above the door and the other on the ceiling next to the main light.</p><p
style="text-align: justify;"><img
class="  aligncenter wp-image-2222" title="PIR sensor looks like the Gregorian system of the Arecibo radiotelescope." src="../wp-content/uploads/sites/2/2015/04/PIR_sensor-300x169.jpg" alt="Domotics with Arduino requires too infrared sensors." width="366" height="206" /></p><p
style="text-align: justify;"><strong><strong> </strong></strong>The<strong> IR receiver</strong> is next to the Arduino board to ensure the maximum visibility to control everything from the <strong>remote control</strong>.</p><p
style="text-align: justify;"><strong><strong><img
class="attachment-266x266 aligncenter" title="IR receiver + Remote Control. It's a bedroom, no one wants to work out there." src="../wp-content/uploads/sites/2/2015/04/IRreceiver-RemoeControl-Internet-300x257.jpg" alt="Domotics with arduino requires to an IR receiver to send commands from the remote control." width="266" height="228" /></strong></strong></p><h2 style="text-align: justify;"><b>Hacking Arduino</b></h2><p
style="text-align: justify;"><strong><strong> </strong></strong>There are great projects using Arduino with domotic pruposes, like <a
href="https://www.openhomeautomation.net/home-automation-arduino/">Open Home Automation</a>, that are very well developed or more specific ones, like <a
href="http://www.souliss.net/">Souliss</a> or <a
href="http://forum.arduino.cc/index.php?topic=179673.0">Excontrol</a>, but those solutions use more than one Arduino board and have more expensive components.</p><p
style="text-align: justify;"><img
class="aligncenter wp-image-2229 size-full" title="Domotics with Arduino" src="../wp-content/uploads/sites/2/2015/04/arduino1.png" alt="Arduino powered by biicode" width="640" height="300" /></p><p
style="text-align: justify;">To program Arduino in a robust and structured way I have chosen <strong>C++ language</strong> and splitted the code in a modular way (the same way the electronics are set-up). This f<span
style="text-decoration: underline;">unctionalities are decoupled and can be incorporated progressively to the domotic system or reused in other similar projects.</span> Here’s where the potential of <strong>biicode&#8217;s way of programming</strong> comes to make the difference.</p><p
style="text-align: justify;">Utilities to incorporate to an Arduino project are countless, but many times there’s no reusable code and you have to completely adapt it. biicode lets you reuse third-party code and include it directly to your project.</p><p
style="text-align: justify;"><strong><strong> </strong></strong>My domotic project is stored at <a
href="http://www.biicode.com/Dani_MTB/Domo/master">Dani_MTB/Domo</a> block and it has two implementations:</p><ul
style="text-align: justify;"><li><em>main.cpp</em>: currently code running in the domotic system of my bedroom.</li><li><em>domo.cpp</em>: parallel implementation to test new features.</li></ul><p
style="text-align: justify;">This is <em>main.cpp&#8217;</em>s code:</p><p></p><div
id="crayon-56886a8eb426c439870146" class="crayon-syntax crayon-theme-biicode crayon-font-inconsolata crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 14px !important; line-height: 15px !important;"><div
class="crayon-toolbar" data-settings=" mouseover hide delay" style="font-size: 14px !important;height: 21px !important; line-height: 21px !important;"><span
class="crayon-title"></span><div
class="crayon-tools" style="font-size: 14px !important;height: 21px !important; line-height: 21px !important;"><div
class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div
class="crayon-button-icon"></div></div><div
class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div
class="crayon-button-icon"></div></div><div
class="crayon-button crayon-expand-button" title="Expand Code"><div
class="crayon-button-icon"></div></div><div
class="crayon-button crayon-copy-button" title="Copy"><div
class="crayon-button-icon"></div></div><div
class="crayon-button crayon-popup-button" title="Open Code In New Window"><div
class="crayon-button-icon"></div></div></div></div><div
class="crayon-info" style="min-height: 19.6px !important; line-height: 19.6px !important;"></div><div
class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 14px !important; line-height: 15px !important;">
#include "kenshirriff/irremote/irremote.h"
#include "Dani_MTB/SimpleTimer/SimpleTimer.h"
#include "Dani_MTB/MultiwaySwitches/MultiwaySwitches.h"
#include "Dani_MTB/Relay/Relay.h"
#include "Dani_MTB/SmartPlug/SmartPlug.h"
#include "Dani_MTB/PIR/PIR.h"
Relay corridorLight;				//Corridor lights of my bedroom
Relay centralLight;		            //Main lights of my bedroom
MultiwaySwitches switchesCentral;	//Two switches (one near my bed and other one at the entrance) that control main lights
MultiwaySwitches switchesCorridor;	//Two switches (one near my bed and other one at the entrance) that control corridor lights
PIR corridorSensor=PIR(14);			//PIR sensor in corridor of my bedroom
PIR centralSensor=PIR(15);			//PIR sensor in the center of my bedroom
SmartPlug rightPlug=SmartPlug(50, LOW_LVL, 200000, 51);	//Plug at the right, pin 50 for relay, activated with a relay with LOW LEVEL, 200 seconds to desactivate, and 51 for PLUG button
IRrecv IR(40);						//Pin for remote IR receiver
decode_results remoteCode;			//Variable to store RemoteControl's codes
bool MODE=false;
void setup()
{
	Serial.begin(9600);
   switchesCentral.setSwitch(2);	//Switch 1 near my bed for main lights
   switchesCentral.setSwitch(3);	//Switch 2 near the door for main lights
   switchesCorridor.setSwitch(4);	//Switch 3 near my bed for corridor lights
   switchesCorridor.setSwitch(5);	//Switch 4 near the door for corridor lights
   centralLight.setup(9, HIGH_LVL);	//Relay (active at HIGH LEVEL) controlling main lights
   centralLight.off();				//Main Lights start OFF (In case power supply of arduino comes OFF and program resets)
   corridorLight.setup(8, LOW_LVL);	//Relay (active at LOW LEVEL) controlling corridor lights
   corridorLight.off();				//Corridor Lights start OFF (In case power supply of arduino comes OFF and program resets)
   IR.enableIRIn();
   IR.blink13(true);
}
void loop()
{
   rightPlug.loop();						//Internal loop for SmartPlug
   if(switchesCentral.change())			//If the state of switches for main lights changes
   {
	   centralLight.commute();				//Commute the state of the main lights
   }
   if(switchesCorridor.change())		//If the state of switches for main lights changes
   {
	   corridorLight.commute();				//Commute the state of the main lights
   }
   if(corridorSensor.rising_edge())		//If there's a positive edge in corridor's PIR sensor (detects a person)
   {
		   corridorLight.on();				//Power ON Corridor Lights
   }
   if(corridorSensor.falling_edge())	//If there's a negative edge in corridor's PIR sensor (NOT detects a person)
   {
	   corridorLight.off();					//Power OFF Corridor Lights
   }
   if(centralSensor.rising_edge())		//If there's a positive edge in main's PIR sensor (detects a person)
   {
		   corridorLight.on();				//Power ON Main Lights
   }
   if(centralSensor.falling_edge())		//If there's a negative edge in main's PIR sensor (NOT detects a person)
   {
	   corridorLight.off();					//Power OFF Main Lights
   }
//+++++++++++++++++++REMOTE CONTROL CODE++++++++++++++++++++++
   if(IR.decode(&amp;remoteCode))
   {
	   if(remoteCode.value==16736925) 	//If MODE button is pressed
		   MODE=true;						//Enable MODE
	   if(remoteCode.value==16753245) 	//If 1 button is pressed Remote Power ON/OFF central light
	   {
		  if(centralLight.getState())		//Power ON/OFF main lights
		  	centralLight.off();
		  else
		  	centralLight.on();
	   }
	   if(remoteCode.value==16724175) 	//If 0 button is pressed
	   {
		   if(rightPlug.getState()) 			//If plug is ON
		  {
			  rightPlug.off();  					//Power off the Plug
		  }
		  else								//If plug is OFF
		  {
			  if(MODE) 							//If MODE is enabled
			  {
				  rightPlug.on_Sensor();				//Power ON Plug in Sensor mode
				  MODE=false;
			  }
			  else								//If MODE is disabled, and plug is OFF
				rightPlug.on();							//Power ON plug in Normal mode
		   }
	   }
	   IR.resume();						//Resume receiving remote codes
   }
// ++++++++++++++++++++DISABLE PLUG IF SENSORS ARE OFF+++++++++++++++++++++
	if(!centralSensor.getState() &amp;&amp; !corridorSensor.getState())	//If both PIR sensors don't detect
	{
		rightPlug.off_Sensor();											//Power off rightPlug in sensor mode
	}
}</textarea></div><div
class="crayon-main" style=""><table
class="crayon-table"><tr
class="crayon-row"><td
class="crayon-nums " data-settings="show"><div
class="crayon-nums-content" style="font-size: 14px !important; line-height: 15px !important;"><div
class="crayon-num" data-line="crayon-56886a8eb426c439870146-1">1</div><div
class="crayon-num crayon-striped-num" data-line="crayon-56886a8eb426c439870146-2">2</div><div
class="crayon-num" data-line="crayon-56886a8eb426c439870146-3">3</div><div
class="crayon-num crayon-striped-num" data-line="crayon-56886a8eb426c439870146-4">4</div><div
class="crayon-num" data-line="crayon-56886a8eb426c439870146-5">5</div><div
class="crayon-num crayon-striped-num" data-line="crayon-56886a8eb426c439870146-6">6</div><div
class="crayon-num" data-line="crayon-56886a8eb426c439870146-7">7</div><div
class="crayon-num crayon-striped-num" data-line="crayon-56886a8eb426c439870146-8">8</div><div
class="crayon-num" data-line="crayon-56886a8eb426c439870146-9">9</div><div
class="crayon-num crayon-striped-num" data-line="crayon-56886a8eb426c439870146-10">10</div><div
class="crayon-num" data-line="crayon-56886a8eb426c439870146-11">11</div><div
class="crayon-num crayon-striped-num" data-line="crayon-56886a8eb426c439870146-12">12</div><div
class="crayon-num" data-line="crayon-56886a8eb426c439870146-13">13</div><div
class="crayon-num crayon-striped-num" data-line="crayon-56886a8eb426c439870146-14">14</div><div
class="crayon-num" data-line="crayon-56886a8eb426c439870146-15">15</div><div
class="crayon-num crayon-striped-num" data-line="crayon-56886a8eb426c439870146-16">16</div><div
class="crayon-num" data-line="crayon-56886a8eb426c439870146-17">17</div><div
class="crayon-num crayon-striped-num" data-line="crayon-56886a8eb426c439870146-18">18</div><div
class="crayon-num" data-line="crayon-56886a8eb426c439870146-19">19</div><div
class="crayon-num crayon-striped-num" data-line="crayon-56886a8eb426c439870146-20">20</div><div
class="crayon-num" data-line="crayon-56886a8eb426c439870146-21">21</div><div
class="crayon-num crayon-striped-num" data-line="crayon-56886a8eb426c439870146-22">22</div><div
class="crayon-num" data-line="crayon-56886a8eb426c439870146-23">23</div><div
class="crayon-num crayon-striped-num" data-line="crayon-56886a8eb426c439870146-24">24</div><div
class="crayon-num" data-line="crayon-56886a8eb426c439870146-25">25</div><div
class="crayon-num crayon-striped-num" data-line="crayon-56886a8eb426c439870146-26">26</div><div
class="crayon-num" data-line="crayon-56886a8eb426c439870146-27">27</div><div
class="crayon-num crayon-striped-num" data-line="crayon-56886a8eb426c439870146-28">28</div><div
class="crayon-num" data-line="crayon-56886a8eb426c439870146-29">29</div><div
class="crayon-num crayon-striped-num" data-line="crayon-56886a8eb426c439870146-30">30</div><div
class="crayon-num" data-line="crayon-56886a8eb426c439870146-31">31</div><div
class="crayon-num crayon-striped-num" data-line="crayon-56886a8eb426c439870146-32">32</div><div
class="crayon-num" data-line="crayon-56886a8eb426c439870146-33">33</div><div
class="crayon-num crayon-striped-num" data-line="crayon-56886a8eb426c439870146-34">34</div><div
class="crayon-num" data-line="crayon-56886a8eb426c439870146-35">35</div><div
class="crayon-num crayon-striped-num" data-line="crayon-56886a8eb426c439870146-36">36</div><div
class="crayon-num" data-line="crayon-56886a8eb426c439870146-37">37</div><div
class="crayon-num crayon-striped-num" data-line="crayon-56886a8eb426c439870146-38">38</div><div
class="crayon-num" data-line="crayon-56886a8eb426c439870146-39">39</div><div
class="crayon-num crayon-striped-num" data-line="crayon-56886a8eb426c439870146-40">40</div><div
class="crayon-num" data-line="crayon-56886a8eb426c439870146-41">41</div><div
class="crayon-num crayon-striped-num" data-line="crayon-56886a8eb426c439870146-42">42</div><div
class="crayon-num" data-line="crayon-56886a8eb426c439870146-43">43</div><div
class="crayon-num crayon-striped-num" data-line="crayon-56886a8eb426c439870146-44">44</div><div
class="crayon-num" data-line="crayon-56886a8eb426c439870146-45">45</div><div
class="crayon-num crayon-striped-num" data-line="crayon-56886a8eb426c439870146-46">46</div><div
class="crayon-num" data-line="crayon-56886a8eb426c439870146-47">47</div><div
class="crayon-num crayon-striped-num" data-line="crayon-56886a8eb426c439870146-48">48</div><div
class="crayon-num" data-line="crayon-56886a8eb426c439870146-49">49</div><div
class="crayon-num crayon-striped-num" data-line="crayon-56886a8eb426c439870146-50">50</div><div
class="crayon-num" data-line="crayon-56886a8eb426c439870146-51">51</div><div
class="crayon-num crayon-striped-num" data-line="crayon-56886a8eb426c439870146-52">52</div><div
class="crayon-num" data-line="crayon-56886a8eb426c439870146-53">53</div><div
class="crayon-num crayon-striped-num" data-line="crayon-56886a8eb426c439870146-54">54</div><div
class="crayon-num" data-line="crayon-56886a8eb426c439870146-55">55</div><div
class="crayon-num crayon-striped-num" data-line="crayon-56886a8eb426c439870146-56">56</div><div
class="crayon-num" data-line="crayon-56886a8eb426c439870146-57">57</div><div
class="crayon-num crayon-striped-num" data-line="crayon-56886a8eb426c439870146-58">58</div><div
class="crayon-num" data-line="crayon-56886a8eb426c439870146-59">59</div><div
class="crayon-num crayon-striped-num" data-line="crayon-56886a8eb426c439870146-60">60</div><div
class="crayon-num" data-line="crayon-56886a8eb426c439870146-61">61</div><div
class="crayon-num crayon-striped-num" data-line="crayon-56886a8eb426c439870146-62">62</div><div
class="crayon-num" data-line="crayon-56886a8eb426c439870146-63">63</div><div
class="crayon-num crayon-striped-num" data-line="crayon-56886a8eb426c439870146-64">64</div><div
class="crayon-num" data-line="crayon-56886a8eb426c439870146-65">65</div><div
class="crayon-num crayon-striped-num" data-line="crayon-56886a8eb426c439870146-66">66</div><div
class="crayon-num" data-line="crayon-56886a8eb426c439870146-67">67</div><div
class="crayon-num crayon-striped-num" data-line="crayon-56886a8eb426c439870146-68">68</div><div
class="crayon-num" data-line="crayon-56886a8eb426c439870146-69">69</div><div
class="crayon-num crayon-striped-num" data-line="crayon-56886a8eb426c439870146-70">70</div><div
class="crayon-num" data-line="crayon-56886a8eb426c439870146-71">71</div><div
class="crayon-num crayon-striped-num" data-line="crayon-56886a8eb426c439870146-72">72</div><div
class="crayon-num" data-line="crayon-56886a8eb426c439870146-73">73</div><div
class="crayon-num crayon-striped-num" data-line="crayon-56886a8eb426c439870146-74">74</div><div
class="crayon-num" data-line="crayon-56886a8eb426c439870146-75">75</div><div
class="crayon-num crayon-striped-num" data-line="crayon-56886a8eb426c439870146-76">76</div><div
class="crayon-num" data-line="crayon-56886a8eb426c439870146-77">77</div><div
class="crayon-num crayon-striped-num" data-line="crayon-56886a8eb426c439870146-78">78</div><div
class="crayon-num" data-line="crayon-56886a8eb426c439870146-79">79</div><div
class="crayon-num crayon-striped-num" data-line="crayon-56886a8eb426c439870146-80">80</div><div
class="crayon-num" data-line="crayon-56886a8eb426c439870146-81">81</div><div
class="crayon-num crayon-striped-num" data-line="crayon-56886a8eb426c439870146-82">82</div><div
class="crayon-num" data-line="crayon-56886a8eb426c439870146-83">83</div><div
class="crayon-num crayon-striped-num" data-line="crayon-56886a8eb426c439870146-84">84</div><div
class="crayon-num" data-line="crayon-56886a8eb426c439870146-85">85</div><div
class="crayon-num crayon-striped-num" data-line="crayon-56886a8eb426c439870146-86">86</div><div
class="crayon-num" data-line="crayon-56886a8eb426c439870146-87">87</div><div
class="crayon-num crayon-striped-num" data-line="crayon-56886a8eb426c439870146-88">88</div><div
class="crayon-num" data-line="crayon-56886a8eb426c439870146-89">89</div><div
class="crayon-num crayon-striped-num" data-line="crayon-56886a8eb426c439870146-90">90</div><div
class="crayon-num" data-line="crayon-56886a8eb426c439870146-91">91</div><div
class="crayon-num crayon-striped-num" data-line="crayon-56886a8eb426c439870146-92">92</div><div
class="crayon-num" data-line="crayon-56886a8eb426c439870146-93">93</div><div
class="crayon-num crayon-striped-num" data-line="crayon-56886a8eb426c439870146-94">94</div><div
class="crayon-num" data-line="crayon-56886a8eb426c439870146-95">95</div><div
class="crayon-num crayon-striped-num" data-line="crayon-56886a8eb426c439870146-96">96</div><div
class="crayon-num" data-line="crayon-56886a8eb426c439870146-97">97</div><div
class="crayon-num crayon-striped-num" data-line="crayon-56886a8eb426c439870146-98">98</div><div
class="crayon-num" data-line="crayon-56886a8eb426c439870146-99">99</div><div
class="crayon-num crayon-striped-num" data-line="crayon-56886a8eb426c439870146-100">100</div><div
class="crayon-num" data-line="crayon-56886a8eb426c439870146-101">101</div><div
class="crayon-num crayon-striped-num" data-line="crayon-56886a8eb426c439870146-102">102</div><div
class="crayon-num" data-line="crayon-56886a8eb426c439870146-103">103</div><div
class="crayon-num crayon-striped-num" data-line="crayon-56886a8eb426c439870146-104">104</div><div
class="crayon-num" data-line="crayon-56886a8eb426c439870146-105">105</div><div
class="crayon-num crayon-striped-num" data-line="crayon-56886a8eb426c439870146-106">106</div><div
class="crayon-num" data-line="crayon-56886a8eb426c439870146-107">107</div><div
class="crayon-num crayon-striped-num" data-line="crayon-56886a8eb426c439870146-108">108</div><div
class="crayon-num" data-line="crayon-56886a8eb426c439870146-109">109</div><div
class="crayon-num crayon-striped-num" data-line="crayon-56886a8eb426c439870146-110">110</div><div
class="crayon-num" data-line="crayon-56886a8eb426c439870146-111">111</div><div
class="crayon-num crayon-striped-num" data-line="crayon-56886a8eb426c439870146-112">112</div><div
class="crayon-num" data-line="crayon-56886a8eb426c439870146-113">113</div><div
class="crayon-num crayon-striped-num" data-line="crayon-56886a8eb426c439870146-114">114</div><div
class="crayon-num" data-line="crayon-56886a8eb426c439870146-115">115</div><div
class="crayon-num crayon-striped-num" data-line="crayon-56886a8eb426c439870146-116">116</div><div
class="crayon-num" data-line="crayon-56886a8eb426c439870146-117">117</div></div></td><td
class="crayon-code"><div
class="crayon-pre" style="font-size: 14px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div
class="crayon-line" id="crayon-56886a8eb426c439870146-1"><span
class="crayon-p">#include "kenshirriff/irremote/irremote.h"</span></div><div
class="crayon-line crayon-striped-line" id="crayon-56886a8eb426c439870146-2"><span
class="crayon-p">#include "Dani_MTB/SimpleTimer/SimpleTimer.h"</span></div><div
class="crayon-line" id="crayon-56886a8eb426c439870146-3"><span
class="crayon-p">#include "Dani_MTB/MultiwaySwitches/MultiwaySwitches.h"</span></div><div
class="crayon-line crayon-striped-line" id="crayon-56886a8eb426c439870146-4"><span
class="crayon-p">#include "Dani_MTB/Relay/Relay.h"</span></div><div
class="crayon-line" id="crayon-56886a8eb426c439870146-5"><span
class="crayon-p">#include "Dani_MTB/SmartPlug/SmartPlug.h"</span></div><div
class="crayon-line crayon-striped-line" id="crayon-56886a8eb426c439870146-6"><span
class="crayon-p">#include "Dani_MTB/PIR/PIR.h"</span></div><div
class="crayon-line" id="crayon-56886a8eb426c439870146-7">&nbsp;</div><div
class="crayon-line crayon-striped-line" id="crayon-56886a8eb426c439870146-8"><span
class="crayon-e">Relay </span><span
class="crayon-v">corridorLight</span><span
class="crayon-sy">;</span><span
class="crayon-h"> </span><span
class="crayon-c">//Corridor lights of my bedroom</span></div><div
class="crayon-line" id="crayon-56886a8eb426c439870146-9"><span
class="crayon-e">Relay </span><span
class="crayon-v">centralLight</span><span
class="crayon-sy">;</span><span
class="crayon-h"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span
class="crayon-c">//Main lights of my bedroom</span></div><div
class="crayon-line crayon-striped-line" id="crayon-56886a8eb426c439870146-10"><span
class="crayon-e">MultiwaySwitches </span><span
class="crayon-v">switchesCentral</span><span
class="crayon-sy">;</span><span
class="crayon-h"> </span><span
class="crayon-c">//Two switches (one near my bed and other one at the entrance) that control main lights</span></div><div
class="crayon-line" id="crayon-56886a8eb426c439870146-11"><span
class="crayon-e">MultiwaySwitches </span><span
class="crayon-v">switchesCorridor</span><span
class="crayon-sy">;</span><span
class="crayon-h"> </span><span
class="crayon-c">//Two switches (one near my bed and other one at the entrance) that control corridor lights</span></div><div
class="crayon-line crayon-striped-line" id="crayon-56886a8eb426c439870146-12"><span
class="crayon-e">PIR </span><span
class="crayon-v">corridorSensor</span><span
class="crayon-o">=</span><span
class="crayon-e">PIR</span><span
class="crayon-sy">(</span><span
class="crayon-cn">14</span><span
class="crayon-sy">)</span><span
class="crayon-sy">;</span><span
class="crayon-h"> </span><span
class="crayon-c">//PIR sensor in corridor of my bedroom</span></div><div
class="crayon-line" id="crayon-56886a8eb426c439870146-13"><span
class="crayon-e">PIR </span><span
class="crayon-v">centralSensor</span><span
class="crayon-o">=</span><span
class="crayon-e">PIR</span><span
class="crayon-sy">(</span><span
class="crayon-cn">15</span><span
class="crayon-sy">)</span><span
class="crayon-sy">;</span><span
class="crayon-h"> </span><span
class="crayon-c">//PIR sensor in the center of my bedroom</span></div><div
class="crayon-line crayon-striped-line" id="crayon-56886a8eb426c439870146-14"><span
class="crayon-e">SmartPlug </span><span
class="crayon-v">rightPlug</span><span
class="crayon-o">=</span><span
class="crayon-e">SmartPlug</span><span
class="crayon-sy">(</span><span
class="crayon-cn">50</span><span
class="crayon-sy">,</span><span
class="crayon-h"> </span><span
class="crayon-v">LOW_LVL</span><span
class="crayon-sy">,</span><span
class="crayon-h"> </span><span
class="crayon-cn">200000</span><span
class="crayon-sy">,</span><span
class="crayon-h"> </span><span
class="crayon-cn">51</span><span
class="crayon-sy">)</span><span
class="crayon-sy">;</span><span
class="crayon-h"> </span><span
class="crayon-c">//Plug at the right, pin 50 for relay, activated with a relay with LOW LEVEL, 200 seconds to desactivate, and 51 for PLUG button </span></div><div
class="crayon-line" id="crayon-56886a8eb426c439870146-15">&nbsp;</div><div
class="crayon-line crayon-striped-line" id="crayon-56886a8eb426c439870146-16"><span
class="crayon-e">IRrecv </span><span
class="crayon-e">IR</span><span
class="crayon-sy">(</span><span
class="crayon-cn">40</span><span
class="crayon-sy">)</span><span
class="crayon-sy">;</span><span
class="crayon-h"> </span><span
class="crayon-c">//Pin for remote IR receiver</span></div><div
class="crayon-line" id="crayon-56886a8eb426c439870146-17"><span
class="crayon-e">decode_results </span><span
class="crayon-v">remoteCode</span><span
class="crayon-sy">;</span><span
class="crayon-h"> </span><span
class="crayon-c">//Variable to store RemoteControl's codes</span></div><div
class="crayon-line crayon-striped-line" id="crayon-56886a8eb426c439870146-18"><span
class="crayon-t">bool</span><span
class="crayon-h"> </span><span
class="crayon-v">MODE</span><span
class="crayon-o">=</span><span
class="crayon-t">false</span><span
class="crayon-sy">;</span></div><div
class="crayon-line" id="crayon-56886a8eb426c439870146-19">&nbsp;</div><div
class="crayon-line crayon-striped-line" id="crayon-56886a8eb426c439870146-20"><span
class="crayon-t">void</span><span
class="crayon-h"> </span><span
class="crayon-e">setup</span><span
class="crayon-sy">(</span><span
class="crayon-sy">)</span></div><div
class="crayon-line" id="crayon-56886a8eb426c439870146-21"><span
class="crayon-sy">{</span></div><div
class="crayon-line crayon-striped-line" id="crayon-56886a8eb426c439870146-22"><span
class="crayon-h"> </span><span
class="crayon-v">Serial</span><span
class="crayon-sy">.</span><span
class="crayon-e">begin</span><span
class="crayon-sy">(</span><span
class="crayon-cn">9600</span><span
class="crayon-sy">)</span><span
class="crayon-sy">;</span></div><div
class="crayon-line" id="crayon-56886a8eb426c439870146-23"><span
class="crayon-h">&nbsp;&nbsp; </span><span
class="crayon-v">switchesCentral</span><span
class="crayon-sy">.</span><span
class="crayon-e">setSwitch</span><span
class="crayon-sy">(</span><span
class="crayon-cn">2</span><span
class="crayon-sy">)</span><span
class="crayon-sy">;</span><span
class="crayon-h"> </span><span
class="crayon-c">//Switch 1 near my bed for main lights</span></div><div
class="crayon-line crayon-striped-line" id="crayon-56886a8eb426c439870146-24"><span
class="crayon-h">&nbsp;&nbsp; </span><span
class="crayon-v">switchesCentral</span><span
class="crayon-sy">.</span><span
class="crayon-e">setSwitch</span><span
class="crayon-sy">(</span><span
class="crayon-cn">3</span><span
class="crayon-sy">)</span><span
class="crayon-sy">;</span><span
class="crayon-h"> </span><span
class="crayon-c">//Switch 2 near the door for main lights</span></div><div
class="crayon-line" id="crayon-56886a8eb426c439870146-25"><span
class="crayon-h">&nbsp;&nbsp; </span><span
class="crayon-v">switchesCorridor</span><span
class="crayon-sy">.</span><span
class="crayon-e">setSwitch</span><span
class="crayon-sy">(</span><span
class="crayon-cn">4</span><span
class="crayon-sy">)</span><span
class="crayon-sy">;</span><span
class="crayon-h"> </span><span
class="crayon-c">//Switch 3 near my bed for corridor lights</span></div><div
class="crayon-line crayon-striped-line" id="crayon-56886a8eb426c439870146-26"><span
class="crayon-h">&nbsp;&nbsp; </span><span
class="crayon-v">switchesCorridor</span><span
class="crayon-sy">.</span><span
class="crayon-e">setSwitch</span><span
class="crayon-sy">(</span><span
class="crayon-cn">5</span><span
class="crayon-sy">)</span><span
class="crayon-sy">;</span><span
class="crayon-h"> </span><span
class="crayon-c">//Switch 4 near the door for corridor lights</span></div><div
class="crayon-line" id="crayon-56886a8eb426c439870146-27">&nbsp;</div><div
class="crayon-line crayon-striped-line" id="crayon-56886a8eb426c439870146-28"><span
class="crayon-h">&nbsp;&nbsp; </span><span
class="crayon-v">centralLight</span><span
class="crayon-sy">.</span><span
class="crayon-e">setup</span><span
class="crayon-sy">(</span><span
class="crayon-cn">9</span><span
class="crayon-sy">,</span><span
class="crayon-h"> </span><span
class="crayon-v">HIGH_LVL</span><span
class="crayon-sy">)</span><span
class="crayon-sy">;</span><span
class="crayon-h"> </span><span
class="crayon-c">//Relay (active at HIGH LEVEL) controlling main lights</span></div><div
class="crayon-line" id="crayon-56886a8eb426c439870146-29"><span
class="crayon-h">&nbsp;&nbsp; </span><span
class="crayon-v">centralLight</span><span
class="crayon-sy">.</span><span
class="crayon-e">off</span><span
class="crayon-sy">(</span><span
class="crayon-sy">)</span><span
class="crayon-sy">;</span><span
class="crayon-h"> </span><span
class="crayon-c">//Main Lights start OFF (In case power supply of arduino comes OFF and program resets)</span></div><div
class="crayon-line crayon-striped-line" id="crayon-56886a8eb426c439870146-30"><span
class="crayon-h">&nbsp;&nbsp; </span><span
class="crayon-v">corridorLight</span><span
class="crayon-sy">.</span><span
class="crayon-e">setup</span><span
class="crayon-sy">(</span><span
class="crayon-cn">8</span><span
class="crayon-sy">,</span><span
class="crayon-h"> </span><span
class="crayon-v">LOW_LVL</span><span
class="crayon-sy">)</span><span
class="crayon-sy">;</span><span
class="crayon-h"> </span><span
class="crayon-c">//Relay (active at LOW LEVEL) controlling corridor lights</span></div><div
class="crayon-line" id="crayon-56886a8eb426c439870146-31"><span
class="crayon-h">&nbsp;&nbsp; </span><span
class="crayon-v">corridorLight</span><span
class="crayon-sy">.</span><span
class="crayon-e">off</span><span
class="crayon-sy">(</span><span
class="crayon-sy">)</span><span
class="crayon-sy">;</span><span
class="crayon-h"> </span><span
class="crayon-c">//Corridor Lights start OFF (In case power supply of arduino comes OFF and program resets)</span></div><div
class="crayon-line crayon-striped-line" id="crayon-56886a8eb426c439870146-32">&nbsp;</div><div
class="crayon-line" id="crayon-56886a8eb426c439870146-33"><span
class="crayon-h">&nbsp;&nbsp; </span><span
class="crayon-v">IR</span><span
class="crayon-sy">.</span><span
class="crayon-e">enableIRIn</span><span
class="crayon-sy">(</span><span
class="crayon-sy">)</span><span
class="crayon-sy">;</span></div><div
class="crayon-line crayon-striped-line" id="crayon-56886a8eb426c439870146-34"><span
class="crayon-h">&nbsp;&nbsp; </span><span
class="crayon-v">IR</span><span
class="crayon-sy">.</span><span
class="crayon-e">blink13</span><span
class="crayon-sy">(</span><span
class="crayon-t">true</span><span
class="crayon-sy">)</span><span
class="crayon-sy">;</span></div><div
class="crayon-line" id="crayon-56886a8eb426c439870146-35">&nbsp;</div><div
class="crayon-line crayon-striped-line" id="crayon-56886a8eb426c439870146-36"><span
class="crayon-sy">}</span></div><div
class="crayon-line" id="crayon-56886a8eb426c439870146-37">&nbsp;</div><div
class="crayon-line crayon-striped-line" id="crayon-56886a8eb426c439870146-38"><span
class="crayon-t">void</span><span
class="crayon-h"> </span><span
class="crayon-e">loop</span><span
class="crayon-sy">(</span><span
class="crayon-sy">)</span></div><div
class="crayon-line" id="crayon-56886a8eb426c439870146-39"><span
class="crayon-sy">{</span></div><div
class="crayon-line crayon-striped-line" id="crayon-56886a8eb426c439870146-40"><span
class="crayon-h">&nbsp;&nbsp; </span><span
class="crayon-v">rightPlug</span><span
class="crayon-sy">.</span><span
class="crayon-e">loop</span><span
class="crayon-sy">(</span><span
class="crayon-sy">)</span><span
class="crayon-sy">;</span><span
class="crayon-h"> </span><span
class="crayon-c">//Internal loop for SmartPlug</span></div><div
class="crayon-line" id="crayon-56886a8eb426c439870146-41"><span
class="crayon-h">&nbsp;&nbsp; </span></div><div
class="crayon-line crayon-striped-line" id="crayon-56886a8eb426c439870146-42"><span
class="crayon-h">&nbsp;&nbsp; </span><span
class="crayon-st">if</span><span
class="crayon-sy">(</span><span
class="crayon-v">switchesCentral</span><span
class="crayon-sy">.</span><span
class="crayon-e">change</span><span
class="crayon-sy">(</span><span
class="crayon-sy">)</span><span
class="crayon-sy">)</span><span
class="crayon-h"> </span><span
class="crayon-c">//If the state of switches for main lights changes</span></div><div
class="crayon-line" id="crayon-56886a8eb426c439870146-43"><span
class="crayon-h">&nbsp;&nbsp; </span><span
class="crayon-sy">{</span></div><div
class="crayon-line crayon-striped-line" id="crayon-56886a8eb426c439870146-44"><span
class="crayon-h"> &nbsp;&nbsp; </span><span
class="crayon-v">centralLight</span><span
class="crayon-sy">.</span><span
class="crayon-e">commute</span><span
class="crayon-sy">(</span><span
class="crayon-sy">)</span><span
class="crayon-sy">;</span><span
class="crayon-h"> </span><span
class="crayon-c">//Commute the state of the main lights</span></div><div
class="crayon-line" id="crayon-56886a8eb426c439870146-45"><span
class="crayon-h">&nbsp;&nbsp; </span><span
class="crayon-sy">}</span></div><div
class="crayon-line crayon-striped-line" id="crayon-56886a8eb426c439870146-46">&nbsp;</div><div
class="crayon-line" id="crayon-56886a8eb426c439870146-47"><span
class="crayon-h">&nbsp;&nbsp; </span><span
class="crayon-st">if</span><span
class="crayon-sy">(</span><span
class="crayon-v">switchesCorridor</span><span
class="crayon-sy">.</span><span
class="crayon-e">change</span><span
class="crayon-sy">(</span><span
class="crayon-sy">)</span><span
class="crayon-sy">)</span><span
class="crayon-h"> </span><span
class="crayon-c">//If the state of switches for main lights changes</span></div><div
class="crayon-line crayon-striped-line" id="crayon-56886a8eb426c439870146-48"><span
class="crayon-h">&nbsp;&nbsp; </span><span
class="crayon-sy">{</span></div><div
class="crayon-line" id="crayon-56886a8eb426c439870146-49"><span
class="crayon-h"> &nbsp;&nbsp; </span><span
class="crayon-v">corridorLight</span><span
class="crayon-sy">.</span><span
class="crayon-e">commute</span><span
class="crayon-sy">(</span><span
class="crayon-sy">)</span><span
class="crayon-sy">;</span><span
class="crayon-h"> </span><span
class="crayon-c">//Commute the state of the main lights</span></div><div
class="crayon-line crayon-striped-line" id="crayon-56886a8eb426c439870146-50"><span
class="crayon-h">&nbsp;&nbsp; </span><span
class="crayon-sy">}</span></div><div
class="crayon-line" id="crayon-56886a8eb426c439870146-51">&nbsp;</div><div
class="crayon-line crayon-striped-line" id="crayon-56886a8eb426c439870146-52"><span
class="crayon-h">&nbsp;&nbsp; </span><span
class="crayon-st">if</span><span
class="crayon-sy">(</span><span
class="crayon-v">corridorSensor</span><span
class="crayon-sy">.</span><span
class="crayon-e">rising_edge</span><span
class="crayon-sy">(</span><span
class="crayon-sy">)</span><span
class="crayon-sy">)</span><span
class="crayon-h"> </span><span
class="crayon-c">//If there's a positive edge in corridor's PIR sensor (detects a person)</span></div><div
class="crayon-line" id="crayon-56886a8eb426c439870146-53"><span
class="crayon-h">&nbsp;&nbsp; </span><span
class="crayon-sy">{</span></div><div
class="crayon-line crayon-striped-line" id="crayon-56886a8eb426c439870146-54"><span
class="crayon-h"> &nbsp;&nbsp; </span><span
class="crayon-v">corridorLight</span><span
class="crayon-sy">.</span><span
class="crayon-e">on</span><span
class="crayon-sy">(</span><span
class="crayon-sy">)</span><span
class="crayon-sy">;</span><span
class="crayon-h"> </span><span
class="crayon-c">//Power ON Corridor Lights</span></div><div
class="crayon-line" id="crayon-56886a8eb426c439870146-55"><span
class="crayon-h">&nbsp;&nbsp; </span><span
class="crayon-sy">}</span></div><div
class="crayon-line crayon-striped-line" id="crayon-56886a8eb426c439870146-56"><span
class="crayon-h">&nbsp;&nbsp; </span></div><div
class="crayon-line" id="crayon-56886a8eb426c439870146-57"><span
class="crayon-h">&nbsp;&nbsp; </span><span
class="crayon-st">if</span><span
class="crayon-sy">(</span><span
class="crayon-v">corridorSensor</span><span
class="crayon-sy">.</span><span
class="crayon-e">falling_edge</span><span
class="crayon-sy">(</span><span
class="crayon-sy">)</span><span
class="crayon-sy">)</span><span
class="crayon-h"> </span><span
class="crayon-c">//If there's a negative edge in corridor's PIR sensor (NOT detects a person)</span></div><div
class="crayon-line crayon-striped-line" id="crayon-56886a8eb426c439870146-58"><span
class="crayon-h">&nbsp;&nbsp; </span><span
class="crayon-sy">{</span></div><div
class="crayon-line" id="crayon-56886a8eb426c439870146-59"><span
class="crayon-h"> &nbsp;&nbsp; </span><span
class="crayon-v">corridorLight</span><span
class="crayon-sy">.</span><span
class="crayon-e">off</span><span
class="crayon-sy">(</span><span
class="crayon-sy">)</span><span
class="crayon-sy">;</span><span
class="crayon-h"> </span><span
class="crayon-c">//Power OFF Corridor Lights </span></div><div
class="crayon-line crayon-striped-line" id="crayon-56886a8eb426c439870146-60"><span
class="crayon-h">&nbsp;&nbsp; </span><span
class="crayon-sy">}</span></div><div
class="crayon-line" id="crayon-56886a8eb426c439870146-61">&nbsp;</div><div
class="crayon-line crayon-striped-line" id="crayon-56886a8eb426c439870146-62">&nbsp;</div><div
class="crayon-line" id="crayon-56886a8eb426c439870146-63"><span
class="crayon-h">&nbsp;&nbsp; </span><span
class="crayon-st">if</span><span
class="crayon-sy">(</span><span
class="crayon-v">centralSensor</span><span
class="crayon-sy">.</span><span
class="crayon-e">rising_edge</span><span
class="crayon-sy">(</span><span
class="crayon-sy">)</span><span
class="crayon-sy">)</span><span
class="crayon-h"> </span><span
class="crayon-c">//If there's a positive edge in main's PIR sensor (detects a person)</span></div><div
class="crayon-line crayon-striped-line" id="crayon-56886a8eb426c439870146-64"><span
class="crayon-h">&nbsp;&nbsp; </span><span
class="crayon-sy">{</span></div><div
class="crayon-line" id="crayon-56886a8eb426c439870146-65"><span
class="crayon-h"> &nbsp;&nbsp; </span><span
class="crayon-v">corridorLight</span><span
class="crayon-sy">.</span><span
class="crayon-e">on</span><span
class="crayon-sy">(</span><span
class="crayon-sy">)</span><span
class="crayon-sy">;</span><span
class="crayon-h"> </span><span
class="crayon-c">//Power ON Main Lights</span></div><div
class="crayon-line crayon-striped-line" id="crayon-56886a8eb426c439870146-66"><span
class="crayon-h">&nbsp;&nbsp; </span><span
class="crayon-sy">}</span></div><div
class="crayon-line" id="crayon-56886a8eb426c439870146-67"><span
class="crayon-h">&nbsp;&nbsp; </span></div><div
class="crayon-line crayon-striped-line" id="crayon-56886a8eb426c439870146-68"><span
class="crayon-h">&nbsp;&nbsp; </span><span
class="crayon-st">if</span><span
class="crayon-sy">(</span><span
class="crayon-v">centralSensor</span><span
class="crayon-sy">.</span><span
class="crayon-e">falling_edge</span><span
class="crayon-sy">(</span><span
class="crayon-sy">)</span><span
class="crayon-sy">)</span><span
class="crayon-h"> </span><span
class="crayon-c">//If there's a negative edge in main's PIR sensor (NOT detects a person)</span></div><div
class="crayon-line" id="crayon-56886a8eb426c439870146-69"><span
class="crayon-h">&nbsp;&nbsp; </span><span
class="crayon-sy">{</span></div><div
class="crayon-line crayon-striped-line" id="crayon-56886a8eb426c439870146-70"><span
class="crayon-h"> &nbsp;&nbsp; </span><span
class="crayon-v">corridorLight</span><span
class="crayon-sy">.</span><span
class="crayon-e">off</span><span
class="crayon-sy">(</span><span
class="crayon-sy">)</span><span
class="crayon-sy">;</span><span
class="crayon-h"> </span><span
class="crayon-c">//Power OFF Main Lights</span></div><div
class="crayon-line" id="crayon-56886a8eb426c439870146-71"><span
class="crayon-h">&nbsp;&nbsp; </span><span
class="crayon-sy">}</span></div><div
class="crayon-line crayon-striped-line" id="crayon-56886a8eb426c439870146-72">&nbsp;</div><div
class="crayon-line" id="crayon-56886a8eb426c439870146-73">&nbsp;</div><div
class="crayon-line crayon-striped-line" id="crayon-56886a8eb426c439870146-74">&nbsp;</div><div
class="crayon-line" id="crayon-56886a8eb426c439870146-75"><span
class="crayon-c">//+++++++++++++++++++REMOTE CONTROL CODE++++++++++++++++++++++</span></div><div
class="crayon-line crayon-striped-line" id="crayon-56886a8eb426c439870146-76"><span
class="crayon-h">&nbsp;&nbsp; </span></div><div
class="crayon-line" id="crayon-56886a8eb426c439870146-77"><span
class="crayon-h">&nbsp;&nbsp; </span><span
class="crayon-st">if</span><span
class="crayon-sy">(</span><span
class="crayon-v">IR</span><span
class="crayon-sy">.</span><span
class="crayon-e">decode</span><span
class="crayon-sy">(</span><span
class="crayon-o">&amp;</span><span
class="crayon-v">remoteCode</span><span
class="crayon-sy">)</span><span
class="crayon-sy">)</span></div><div
class="crayon-line crayon-striped-line" id="crayon-56886a8eb426c439870146-78"><span
class="crayon-h">&nbsp;&nbsp; </span><span
class="crayon-sy">{</span></div><div
class="crayon-line" id="crayon-56886a8eb426c439870146-79"><span
class="crayon-h"> &nbsp;&nbsp; </span><span
class="crayon-st">if</span><span
class="crayon-sy">(</span><span
class="crayon-v">remoteCode</span><span
class="crayon-sy">.</span><span
class="crayon-v">value</span><span
class="crayon-o">==</span><span
class="crayon-cn">16736925</span><span
class="crayon-sy">)</span><span
class="crayon-h"> </span><span
class="crayon-c">//If MODE button is pressed</span></div><div
class="crayon-line crayon-striped-line" id="crayon-56886a8eb426c439870146-80"><span
class="crayon-h"> &nbsp;&nbsp; </span><span
class="crayon-v">MODE</span><span
class="crayon-o">=</span><span
class="crayon-t">true</span><span
class="crayon-sy">;</span><span
class="crayon-h"> </span><span
class="crayon-c">//Enable MODE</span></div><div
class="crayon-line" id="crayon-56886a8eb426c439870146-81">&nbsp;</div><div
class="crayon-line crayon-striped-line" id="crayon-56886a8eb426c439870146-82"><span
class="crayon-h"> &nbsp;&nbsp; </span><span
class="crayon-st">if</span><span
class="crayon-sy">(</span><span
class="crayon-v">remoteCode</span><span
class="crayon-sy">.</span><span
class="crayon-v">value</span><span
class="crayon-o">==</span><span
class="crayon-cn">16753245</span><span
class="crayon-sy">)</span><span
class="crayon-h"> </span><span
class="crayon-c">//If 1 button is pressed Remote Power ON/OFF central light</span></div><div
class="crayon-line" id="crayon-56886a8eb426c439870146-83"><span
class="crayon-h"> &nbsp;&nbsp; </span><span
class="crayon-sy">{</span></div><div
class="crayon-line crayon-striped-line" id="crayon-56886a8eb426c439870146-84"><span
class="crayon-h"> &nbsp;&nbsp;</span><span
class="crayon-st">if</span><span
class="crayon-sy">(</span><span
class="crayon-v">centralLight</span><span
class="crayon-sy">.</span><span
class="crayon-e">getState</span><span
class="crayon-sy">(</span><span
class="crayon-sy">)</span><span
class="crayon-sy">)</span><span
class="crayon-h"> </span><span
class="crayon-c">//Power ON/OFF main lights</span></div><div
class="crayon-line" id="crayon-56886a8eb426c439870146-85"><span
class="crayon-h"> &nbsp;&nbsp; </span><span
class="crayon-v">centralLight</span><span
class="crayon-sy">.</span><span
class="crayon-e">off</span><span
class="crayon-sy">(</span><span
class="crayon-sy">)</span><span
class="crayon-sy">;</span></div><div
class="crayon-line crayon-striped-line" id="crayon-56886a8eb426c439870146-86"><span
class="crayon-h"> &nbsp;&nbsp;</span><span
class="crayon-st">else</span></div><div
class="crayon-line" id="crayon-56886a8eb426c439870146-87"><span
class="crayon-h"> &nbsp;&nbsp; </span><span
class="crayon-v">centralLight</span><span
class="crayon-sy">.</span><span
class="crayon-e">on</span><span
class="crayon-sy">(</span><span
class="crayon-sy">)</span><span
class="crayon-sy">;</span></div><div
class="crayon-line crayon-striped-line" id="crayon-56886a8eb426c439870146-88"><span
class="crayon-h"> &nbsp;&nbsp; </span><span
class="crayon-sy">}</span></div><div
class="crayon-line" id="crayon-56886a8eb426c439870146-89">&nbsp;</div><div
class="crayon-line crayon-striped-line" id="crayon-56886a8eb426c439870146-90"><span
class="crayon-h"> &nbsp;&nbsp; </span><span
class="crayon-st">if</span><span
class="crayon-sy">(</span><span
class="crayon-v">remoteCode</span><span
class="crayon-sy">.</span><span
class="crayon-v">value</span><span
class="crayon-o">==</span><span
class="crayon-cn">16724175</span><span
class="crayon-sy">)</span><span
class="crayon-h"> </span><span
class="crayon-c">//If 0 button is pressed</span></div><div
class="crayon-line" id="crayon-56886a8eb426c439870146-91"><span
class="crayon-h"> &nbsp;&nbsp; </span><span
class="crayon-sy">{</span></div><div
class="crayon-line crayon-striped-line" id="crayon-56886a8eb426c439870146-92"><span
class="crayon-h"> &nbsp;&nbsp; </span><span
class="crayon-st">if</span><span
class="crayon-sy">(</span><span
class="crayon-v">rightPlug</span><span
class="crayon-sy">.</span><span
class="crayon-e">getState</span><span
class="crayon-sy">(</span><span
class="crayon-sy">)</span><span
class="crayon-sy">)</span><span
class="crayon-h"> </span><span
class="crayon-c">//If plug is ON</span></div><div
class="crayon-line" id="crayon-56886a8eb426c439870146-93"><span
class="crayon-h"> &nbsp;&nbsp;</span><span
class="crayon-sy">{</span></div><div
class="crayon-line crayon-striped-line" id="crayon-56886a8eb426c439870146-94"><span
class="crayon-h"> &nbsp;&nbsp;</span><span
class="crayon-v">rightPlug</span><span
class="crayon-sy">.</span><span
class="crayon-e">off</span><span
class="crayon-sy">(</span><span
class="crayon-sy">)</span><span
class="crayon-sy">;</span><span
class="crayon-h">&nbsp;&nbsp; </span><span
class="crayon-c">//Power off the Plug</span></div><div
class="crayon-line" id="crayon-56886a8eb426c439870146-95"><span
class="crayon-h"> &nbsp;&nbsp;</span><span
class="crayon-sy">}</span></div><div
class="crayon-line crayon-striped-line" id="crayon-56886a8eb426c439870146-96"><span
class="crayon-h"> &nbsp;&nbsp;</span><span
class="crayon-st">else</span><span
class="crayon-h"> </span><span
class="crayon-c">//If plug is OFF</span></div><div
class="crayon-line" id="crayon-56886a8eb426c439870146-97"><span
class="crayon-h"> &nbsp;&nbsp;</span><span
class="crayon-sy">{</span></div><div
class="crayon-line crayon-striped-line" id="crayon-56886a8eb426c439870146-98"><span
class="crayon-h"> &nbsp;&nbsp;</span><span
class="crayon-st">if</span><span
class="crayon-sy">(</span><span
class="crayon-v">MODE</span><span
class="crayon-sy">)</span><span
class="crayon-h"> </span><span
class="crayon-c">//If MODE is enabled</span></div><div
class="crayon-line" id="crayon-56886a8eb426c439870146-99"><span
class="crayon-h"> &nbsp;&nbsp;</span><span
class="crayon-sy">{</span></div><div
class="crayon-line crayon-striped-line" id="crayon-56886a8eb426c439870146-100"><span
class="crayon-h"> &nbsp;&nbsp;</span><span
class="crayon-v">rightPlug</span><span
class="crayon-sy">.</span><span
class="crayon-e">on_Sensor</span><span
class="crayon-sy">(</span><span
class="crayon-sy">)</span><span
class="crayon-sy">;</span><span
class="crayon-h"> </span><span
class="crayon-c">//Power ON Plug in Sensor mode</span></div><div
class="crayon-line" id="crayon-56886a8eb426c439870146-101"><span
class="crayon-h"> &nbsp;&nbsp;</span><span
class="crayon-v">MODE</span><span
class="crayon-o">=</span><span
class="crayon-t">false</span><span
class="crayon-sy">;</span></div><div
class="crayon-line crayon-striped-line" id="crayon-56886a8eb426c439870146-102"><span
class="crayon-h"> &nbsp;&nbsp;</span><span
class="crayon-sy">}</span></div><div
class="crayon-line" id="crayon-56886a8eb426c439870146-103"><span
class="crayon-h"> &nbsp;&nbsp;</span><span
class="crayon-st">else</span><span
class="crayon-h"> </span><span
class="crayon-c">//If MODE is disabled, and plug is OFF</span></div><div
class="crayon-line crayon-striped-line" id="crayon-56886a8eb426c439870146-104"><span
class="crayon-h"> </span><span
class="crayon-v">rightPlug</span><span
class="crayon-sy">.</span><span
class="crayon-e">on</span><span
class="crayon-sy">(</span><span
class="crayon-sy">)</span><span
class="crayon-sy">;</span><span
class="crayon-h"> </span><span
class="crayon-c">//Power ON plug in Normal mode</span></div><div
class="crayon-line" id="crayon-56886a8eb426c439870146-105"><span
class="crayon-h"> &nbsp;&nbsp; </span><span
class="crayon-sy">}</span></div><div
class="crayon-line crayon-striped-line" id="crayon-56886a8eb426c439870146-106"><span
class="crayon-h"> &nbsp;&nbsp; </span><span
class="crayon-sy">}</span></div><div
class="crayon-line" id="crayon-56886a8eb426c439870146-107"><span
class="crayon-h"> &nbsp;&nbsp; </span><span
class="crayon-v">IR</span><span
class="crayon-sy">.</span><span
class="crayon-e">resume</span><span
class="crayon-sy">(</span><span
class="crayon-sy">)</span><span
class="crayon-sy">;</span><span
class="crayon-h"> </span><span
class="crayon-c">//Resume receiving remote codes</span></div><div
class="crayon-line crayon-striped-line" id="crayon-56886a8eb426c439870146-108"><span
class="crayon-h">&nbsp;&nbsp; </span><span
class="crayon-sy">}</span></div><div
class="crayon-line" id="crayon-56886a8eb426c439870146-109">&nbsp;</div><div
class="crayon-line crayon-striped-line" id="crayon-56886a8eb426c439870146-110">&nbsp;</div><div
class="crayon-line" id="crayon-56886a8eb426c439870146-111"><span
class="crayon-c">// ++++++++++++++++++++DISABLE PLUG IF SENSORS ARE OFF+++++++++++++++++++++</span></div><div
class="crayon-line crayon-striped-line" id="crayon-56886a8eb426c439870146-112">&nbsp;</div><div
class="crayon-line" id="crayon-56886a8eb426c439870146-113"><span
class="crayon-h"> </span><span
class="crayon-st">if</span><span
class="crayon-sy">(</span><span
class="crayon-o">!</span><span
class="crayon-v">centralSensor</span><span
class="crayon-sy">.</span><span
class="crayon-e">getState</span><span
class="crayon-sy">(</span><span
class="crayon-sy">)</span><span
class="crayon-h"> </span><span
class="crayon-o">&amp;&amp;</span><span
class="crayon-h"> </span><span
class="crayon-o">!</span><span
class="crayon-v">corridorSensor</span><span
class="crayon-sy">.</span><span
class="crayon-e">getState</span><span
class="crayon-sy">(</span><span
class="crayon-sy">)</span><span
class="crayon-sy">)</span><span
class="crayon-h"> </span><span
class="crayon-c">//If both PIR sensors don't detect</span></div><div
class="crayon-line crayon-striped-line" id="crayon-56886a8eb426c439870146-114"><span
class="crayon-h"> </span><span
class="crayon-sy">{</span></div><div
class="crayon-line" id="crayon-56886a8eb426c439870146-115"><span
class="crayon-h"> </span><span
class="crayon-v">rightPlug</span><span
class="crayon-sy">.</span><span
class="crayon-e">off_Sensor</span><span
class="crayon-sy">(</span><span
class="crayon-sy">)</span><span
class="crayon-sy">;</span><span
class="crayon-h"> </span><span
class="crayon-c">//Power off rightPlug in sensor mode </span></div><div
class="crayon-line crayon-striped-line" id="crayon-56886a8eb426c439870146-116"><span
class="crayon-h"> </span><span
class="crayon-sy">}</span></div><div
class="crayon-line" id="crayon-56886a8eb426c439870146-117"><span
class="crayon-sy">}</span></div></div></td></tr></table></div></div><p></p><p
style="text-align: justify;">As you can see there are some class definitions that make the program look so much cleaner and it also makes it easy to understand what&#8217;s going on!</p><h3 style="text-align: justify;">Reusing code: Make domotics powerful</h3><p
style="text-align: justify;">If you take a look at [requirements] section you&#8217;ll notice that some portions of code (the classes used in the code) are reused from other blocks, and even those other blocks reuse more blocks again.</p><p
style="text-align: justify;"><img
class="aligncenter wp-image-2224 size-full" title="Domo's requirements" src="../wp-content/uploads/sites/2/2015/04/requirements-domo.png" alt="Requirements of Domo: Domotics with Arduino" width="848" height="541" /></p><p
style="text-align: justify;">Here is a brief explanation for each one:</p><ul
style="text-align: justify;"><li><strong>MultiwaySwitches: </strong><a
href="https://www.biicode.com/Dani_MTB/MultiwaySwitches">This block</a> implements a C++ class that encapsulates the usage of three-way switches that power on and off the same light. Switches  are now digital arduino inputs (5v), which is safer for people when manipulating them.</li><li><strong>SmartPlug:</strong> <a
href="https://www.biicode.com/Dani_MTB/SmartPlug">Here is where the code for plugs is stored</a>. This class incorporates the activation of power supply by a relay when a button is pressed. You can select two modes: Normal activation and Sensor activation. It also incorporates a security time to automatically power off the plug. SmartPlug is useful if you want to connect an electric stove for example. This block reuses some other utilities in other blocks of biicode like <a
href="https://www.biicode.com/Dani_MTB/SimpleTimer">SimpleTimer</a>, <a
href="https://www.biicode.com/hithwen/button">Button</a> or <a
href="https://www.biicode.com/Dani_MTB/Relay">Relay</a>.</li><li><strong>Relay: </strong><a
href="https://www.biicode.com/Dani_MTB/Relay">Relay block</a> simplifies the usage of relays with arduino (handles HIGH or LOW level activation). In my case, it is useful to control lights and plugs.</li><li><strong>IRremote: </strong><a
href="https://www.biicode.com/kenshirriff/irremote">IRremote </a>implements and simplifies the usage of a remote control receiver for different kinds of standard remotes.</li><li><strong>PIR:</strong> <a
href="https://www.biicode.com/Dani_MTB/PIR">A class that encapsulates PIR sensor’s code</a>, with methods to detect rising or falling edges and the state of the sensor.</li></ul><p
style="text-align: justify;">Other developed classes and utilities are already allocated in biicode so you can incorporate and use them in your project with just an #include: <a
href="http://www.biicode.com/Dani_MTB/Clock">Clock</a> (Non-blocking Real Time clock without RTC module), <a
href="https://www.biicode.com/pablotoledo/pablotoledo/drinkuino_arduino/master/1/libs/ultrasonic/ultrasonic.h">Ultrasonic</a>&#8230;</p><h2 style="text-align: justify;">Future implementations</h2><p
style="text-align: justify;">There’s still a lot work ahead in my small domotic system based in arduino: internet wireless connection, a graphical user interface with a display (under construction), blind implementation… However, thanks to its modularity, robust C++ code and biicode powered Arduino, this system is a great bet to achieve a full domotic system for our bedroom.</p><p
style="text-align: justify;">As always, we&#8217;re available at our <a
title="biicode forum" href="forum.biicode.html">forum </a>or <a
title="biicode tagged questions" href="http://stackoverflow.com/questions/tagged/biicode">Stackoverflow tag</a>. You can also <a
title="support mail" href="mailto:support@biicode.com" target="_blank">write us</a> and request features at <a
href="http://web.biicode.com/community/roadmap/" target="_blank">our roadmap.</a></p><hr
class="dot-line" />Related Posts<ul><li><a
href="../control-lights-open-source-hack/index.html" title="Open source hack with biicode: Control lights with Arduino.">Open source hack with biicode: Control lights with Arduino.</a></li><li><a
href="../adapt-arduino-sketches-i/index.html" title="How to adapt your Arduino sketches (I)">How to adapt your Arduino sketches (I)</a></li><li><a
href="../arduino-yun/index.html" title="Arduino Yun now supported">Arduino Yun now supported</a></li><li><a
href="../unleash-arduino-projects/index.html" title="Unleash your Arduino projects">Unleash your Arduino projects</a></li></ul><div
class="addthis_toolbox addthis_default_style addthis_32x32_style" addthis:url='http://blog.biicode.com/domotics-with-arduino/' addthis:title='Project Domo: Domotics with Arduino' ><a
class="addthis_button_facebook"></a><a
class="addthis_button_twitter"></a><a
class="addthis_button_google_plusone_share"></a><a
class="addthis_button_compact"></a><a
class="addthis_counter addthis_bubble_style"></a></div></div> <footer
class="entry-meta"> This entry was posted in <a
href="../category/arduino/index.html" rel="category tag">Arduino</a> and tagged <a
href="../tag/arduino-2/index.html" rel="tag">arduino</a>, <a
href="../tag/domotics/index.html" rel="tag">domotics</a>, <a
href="../tag/domotics-with-arduino/index.html" rel="tag">Domotics with Arduino</a>, <a
href="../tag/project-domo/index.html" rel="tag">Project Domo</a>. Bookmark the <a
href="index.html" title="Permalink to Project Domo: Domotics with Arduino" rel="bookmark">permalink</a>. </footer> </article> <nav
role="navigation" id="nav-below" class="navigation-post"><h1 class="screen-reader-text">Post navigation</h1><div
class="previous"><a
href="../versioneye-announcement/index.html" rel="prev"><span
class="meta-nav">&larr;</span> biicode works now with VersionEye</a></div><div
class="next"><a
href="../compiling-with-biicode-cmake-build-process-ides-and-more/index.html" rel="next">Compiling with biicode: CMake, build process, IDEs and more <span
class="meta-nav">&rarr;</span></a></div> </nav><div
id="disqus_thread"></div> <script type="text/javascript">var disqus_url = 'index.html';
var disqus_identifier = '2207%20http_/blog.biicode.com/index1311.html?p=2207';
var disqus_container_id = 'disqus_thread';
var disqus_shortname = 'biicodeblog';
var disqus_title = "Project Domo: Domotics with Arduino";
var disqus_config_custom = window.disqus_config;
var disqus_config = function () {
    /*
    All currently supported events:
    onReady: fires when everything is ready,
    onNewComment: fires when a new comment is posted,
    onIdentify: fires when user is authenticated
    */
    this.language = '';
        this.callbacks.onReady.push(function () {
        // sync comments in the background so we don't block the page
        var script = document.createElement('script');
        script.async = true;
        script.src = 'indexdd3b.html?cf_action=sync_comments&amp;post_id=2207';
        var firstScript = document.getElementsByTagName('script')[0];
        firstScript.parentNode.insertBefore(script, firstScript);
    });
    if (disqus_config_custom) {
        disqus_config_custom.call(this);
    }
};
(function() {
    var dsq = document.createElement('script'); dsq.type = 'text/javascript';
    dsq.async = true;
    dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
})();</script> </div></div><div
id="secondary" class="widget-area" role="complementary"> <aside
id="text-2" class="widget widget_text"><div
class="textwidget"><p
class="widgettitleWhatwedo" align="center"> biicode is:</p><p
class="hrOrange">&nbsp;</p><p
align="center" class="widgetxtWhatwedo">For <span
style="font-weight:normal">C/C++ developers,</span> biicode is a file-based dependencies manager that makes code reuse simple.</p><div
id="Sidebar-Tryforfree"> <img
src="../wp-content/uploads/sites/3/2014/05/try-it-for-free-on.jpg" /> <a
href="http://www.biicode.com/downloads"><img
class="top" src="../wp-content/uploads/sites/3/2014/05/try-it-for-free-off.jpg" /></a></div></div> </aside><aside
id="text-3" class="widget widget_text"><div
class="textwidget"> <a
href="https://www.biicode.com/biicode-open-source-challenge"><img
src="../wp-content/uploads/sites/3/2014/05/banner-open-source.jpg" /></a></div> </aside><aside
id="categories-2" class="widget widget_categories"><h1 class="widget-title">Categories</h1><label
class="screen-reader-text" for="cat">Categories</label><select
name='cat' id='cat' class='postform' ><option
value='-1'>Select Category</option><option
class="level-0" value="3">#biicontest2014</option><option
class="level-0" value="328">algorithms</option><option
class="level-0" value="350">Arduino</option><option
class="level-0" value="12">biicode</option><option
class="level-0" value="173">biicode-internals</option><option
class="level-0" value="7">biicoders</option><option
class="level-0" value="229">BITSCAN</option><option
class="level-0" value="372">c++</option><option
class="level-0" value="49">events</option><option
class="level-0" value="198">Gamedev</option><option
class="level-0" value="318">Integrations</option><option
class="level-0" value="209">Meta-programming</option><option
class="level-0" value="43">news</option><option
class="level-0" value="163">Our Story</option><option
class="level-0" value="269">Software design</option><option
class="level-0" value="50">try this out</option><option
class="level-0" value="225">ZeroMQ</option> </select> <script type='text/javascript'>/*  */
(function() {
	var dropdown = document.getElementById( "cat" );
	function onCatChange() {
		if ( dropdown.options[ dropdown.selectedIndex ].value > 0 ) {
			location.href = "http://blog.biicode.com/?cat=" + dropdown.options[ dropdown.selectedIndex ].value;
		}
	}
	dropdown.onchange = onCatChange;
})();
/*  */</script> </aside></div></div></div><div
id="containerfooter"> <footer><div
class="center"><div
class="footer-item company"><h3>About</h3><ul><li><a
href="http://web.biicode.com/about-us">Company</a></li><li><a
href="http://web.biicode.com/pricing">Pricing</a></li><li><a
href="http://web.biicode.com/jobs">Careers</a></li><li><a
href="http://web.biicode.com/meet-the-team">Team </a></li><li><a
href="http://web.biicode.com/contact-us/">Contact us </a></li></ul></div><div
class="footer-item contact"><h3>Features</h3><ul><li><a
href="http://web.biicode.com/features/arduino/">Arduino</a></li><li><a
href="http://web.biicode.com/features/raspberry-pi/">Raspberry Pi</a></li><li><a
href="http://web.biicode.com/features/cpp/">C/C++</a></li><li><a
href="http://web.biicode.com/features/nodejs/">Node.js</a></li></ul></div><div
class="footer-item resources"><h3>Resources</h3><ul><li><a
href="http://web.biicode.com/learn/getting-started">Getting Started</a></li><li><a
href="https://www.biicode.com/downloads">Downloads </a></li><li><a
href="http://www.biicode.com/explore">Explore</a></li><li><a
href="http://docs.biicode.com/">Documentation</a></li><li><a
href="http://forum.biicode.com/">Forum</a></li><li><a
href="../index.html">Blog</a></li></ul></div><div
class="footer-item resources"><h3>Community</h3><ul><li><a
href="http://web.biicode.com/community/friends/">Friends</a></li><li><a
href="http://web.biicode.com/community/roadmap/">Roadmap</a></li></ul></div><div
class="signupfooter"><div
id="signupfooter-bt"> <img
src="../wp-content/themes/truly-minimal-wpcom/img/footer/bt-sign-up-footer-on.png" /> <a
href="https://www.biicode.com/accounts/signup/"><img
class="top" src="../wp-content/themes/truly-minimal-wpcom/img/footer/bt-sign-up-footer-off.png" /></a></div><div
id="socialiconsfooter-bt"> <img
src="../wp-content/themes/truly-minimal-wpcom/img/footer/icon-fb-footer-on.png" /> <a
href="https://www.facebook.com/Biicode"><img
class="top" src="../wp-content/themes/truly-minimal-wpcom/img/footer/icon-fb-footer-off.png" /></a></div><div
id="socialiconsfooter-bt"> <img
src="../wp-content/themes/truly-minimal-wpcom/img/footer/icon-twitter-footer-on.png" /> <a
href="https://twitter.com/biicode"><img
class="top" src="../wp-content/themes/truly-minimal-wpcom/img/footer/icon-twitter-footer-off.png" /></a></div><div
id="socialiconsfooter-bt"> <img
src="../wp-content/themes/truly-minimal-wpcom/img/footer/icon-google-footer-on.png" /> <a
href="https://plus.google.com/110838391970414654069/posts"><img
class="top" src="../wp-content/themes/truly-minimal-wpcom/img/footer/icon-google-footer-off.png" /></a></div><div
id="socialiconsfooter-bt"> <img
src="../wp-content/themes/truly-minimal-wpcom/img/footer/icon-linkedin-footer-on.png" /> <a
href="http://www.linkedin.com/company/biicode"><img
class="top" src="../wp-content/themes/truly-minimal-wpcom/img/footer/icon-linkedin-footer-off.png" /></a></div></div><div
class="center copyright"> <img
src="../wp-content/themes/truly-minimal-wpcom/img/footer/biicoce-logo-footer.png" class="logo" width="32" height="42" /><p>© 2014 Biicode. All rights reserved · <a
href="http://web.biicode.com/legal/terms-and-conditions">Terms and conditions</a> · <a
href="http://web.biicode.com/legal/privacy-policy">Privacy Policy</a> · <a
href="http://web.biicode.com/legal/community-guidelines">Community guidelines</a></p></div></div> </footer></div>
 <script type="text/javascript">//
			jQuery(document).ready(function() {
				// Edit 09/05: remove globals and package into Object Literal, and removed the debug function
				cli_show_cookiebar({
					html: '<div id="cookie-law-info-bar"><span>This website uses cookies to improve your experience. We\'ll assume you\'re ok with this, but you can opt-out if you wish.<a href=\"#\" id=\"cookie_action_close_header\"  class=\"medium cli-plugin-button cli-plugin-main-button\" >Accept</a> <a href=\"http://web.biicode.com/legal/privacy-policy/\" id=\"CONSTANT_OPEN_URL\" target=\"_new\"  class=\"cli-plugin-main-link\"  >Read More</a></span></div><div id="cookie-law-info-again"><span id="cookie_hdr_showagain">Privacy & Cookies Policy</span></div>',
					settings: '{"animate_speed_hide":"500","animate_speed_show":"500","background":"#fff","border":"#444","border_on":true,"button_1_button_colour":"#000000","button_1_button_hover":"#000000","button_1_link_colour":"#fff","button_1_as_button":true,"button_2_button_colour":"#333","button_2_button_hover":"#292929","button_2_link_colour":"#444","button_2_as_button":false,"font_family":"Arial, Helvetica, sans-serif","notify_animate_hide":true,"notify_animate_show":false,"notify_div_id":"#cookie-law-info-bar","notify_position_horizontal":"right","notify_position_vertical":"bottom","scroll_close":false,"scroll_close_reload":false,"showagain_tab":true,"showagain_background":"#fff","showagain_border":"#000","showagain_div_id":"#cookie-law-info-again","showagain_x_position":"100px","text":"#000","show_once_yn":false,"show_once":"10000"}'
				});
			});
			//</script> <script type="text/javascript">// 
        var disqus_shortname = 'biicodeblog';
        (function () {
            var nodes = document.getElementsByTagName('span');
            for (var i = 0, url; i < nodes.length; i++) {
                if (nodes[i].className.indexOf('dsq-postid') != -1) {
                    nodes[i].parentNode.setAttribute('data-disqus-identifier', nodes[i].getAttribute('data-dsqidentifier'));
                    url = nodes[i].parentNode.href.split('#', 1);
                    if (url.length == 1) { url = url[0]; }
                    else { url = url[1]; }
                    nodes[i].parentNode.href = url + '#disqus_thread';
                }
            }
            var s = document.createElement('script');
            s.async = true;
            s.type = 'text/javascript';
            s.src = '//' + disqus_shortname + '.disqus.com/count.js';
            (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
        }());
        //</script><script type="text/javascript">if (typeof(addthis_share) == "undefined"){ addthis_share = {"passthrough":{"twitter":{"via":"biicode"}}};}

var addthis_config = {"data_track_clickback":false,"data_track_addressbar":false,"data_track_textcopy":false,"ui_atversion":"300"};
var addthis_product = 'wpp-4.0.7';
</script><script type="text/javascript" src="../../s7.addthis.com/js/300/addthis_widget.js#pubid=ra-522dcd676fbf553f"></script><script type="text/javascript">
jQuery(window).load(function(){
  var q2w3_sidebar_1_options = { "sidebar" : "sidebar-1", "margin_top" : 10, "margin_bottom" : 450, "screen_max_width" : 0, "width_inherit" : false, "widgets" : ['text-2','text-3','categories-2'] };
  q2w3_sidebar(q2w3_sidebar_1_options);
  setInterval(function () { q2w3_sidebar(q2w3_sidebar_1_options); }, 1500);
});
</script>
<script type='text/javascript' src='../wp-content/themes/truly-minimal-wpcom/js/navigation11a8.js?ver=20120206'></script>
<script type='text/javascript' src='../wp-content/themes/truly-minimal-wpcom/js/skip-link-focus-fix08e0.js?ver=20130115'></script>
<script type='text/javascript' src='../wp-includes/js/comment-reply.mind19b.js?ver=4.2.5'></script>
<!--wp_footer-->
</body>

<!-- Mirrored from blog.biicode.com/domotics-with-arduino/ by HTTrack Website Copier/3.x [XR&CO'2014], Sun, 03 Jan 2016 00:31:43 GMT -->
</html>